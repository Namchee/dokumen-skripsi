\chapter{Perancangan}
\label{chap:perancangan}

Sebelum melalui tahap implementasi, perangkat lunak perlu melalui proses perancangan perangkat lunak. Perancangan perangkat lunak merupakan sebuah proses untuk mengidentifikasi artefak-artefak dari perangkat lunak seperti modul, fungsi, kelas, serta artefak-artefak lainnya yang bertujuan untuk memenuhi kebutuhan perangkat lunak. Manfaat utama dari perancangan perangkat lunak adalah supaya perilaku perangkat lunak yang dihasilkan dapat lebih mudah diprediksi dan dikontrol sehingga perangkat lunak dapat lebih mudah dikembangkan dan diperbaiki di masa depan \cite{budgen:04:software-design}.

Melalui proses analisis kebutuhan perangkat lunak, maka perangkat lunak yang akan dibuat harus memiliki 2 fungsionalitas berikut:

\begin{enumerate}
    \item Membaca dan memahami masukan dari pengguna berupa data pergerakan pejalan kaki dan parameter rombongan,
    \item Melakukan identifikasi kelompok-kelompok rombongan yang terbentuk dalam data pergerakan pejalan kaki yang diberikan dalam masukan pengguna.
\end{enumerate}

Berdasarkan 2 kebutuhan tersebut, diputuskan bahwa perangkat lunak akan memiliki antarmuka pengguna dalam bentuk \textit{command line interface} sederhana. Interaksi antara pengguna dan perangkat lunak berdasarkan kedua fungsionalitas tersebut digambarkan melalui diagram konteks yang ditunjukkan melalui gambar \ref{bab4:context-diagram}.

\begin{figure}[h]
    \centering
    \includegraphics[width=0.55\textwidth]{Gambar/bab4:dfd-level-0.pdf}
    \caption{Diagram konteks}
    \label{bab4:context-diagram}
\end{figure}

\noindent Kedua fungsionalitas dari perangkat lunak akan dipecah menjadi 3 modul utama yaitu:

\begin{enumerate}
    \item \textbf{Modul I/O}
    
    Modul I/O merupakan modul yang berfungsi untuk membaca masukan pengguna dan mencetak hasil identifikasi rombongan yang dihasilkan oleh modul Rombongan. Terdapat dua proses yang akan dikerjakan oleh modul I/O, yaitu proses penerjemahan masukan dan proses pembuatan berkas hasil.
    
    \item \textbf{Modul Penerjemah}
    
    Modul Penerjemah merupakan modul yang berfungsi untuk menerjemahkan berkas masukan data pejalan kaki menjadi data yang dapat dipahami dan digunakan oleh perangkat lunak. Terdapat satu proses yang akan dikerjakan oleh modul penerjemah, yaitu proses penerjemahan data pergerakan.
    
    \item \textbf{Modul Rombongan}
    
    Modul Rombongan merupakan modul yang berfungsi untuk mengidentifikasi kumpulan rombongan yang terbentuk dalam data pergerakan pejalan kaki yang sudah diterjemahkan oleh modul Penerjemah. Terdapat satu proses yang akan dikerjakan oleh modul rombongan, yaitu proses identifikasi rombongan.
\end{enumerate}

Interaksi antar ketiga modul tersebut ditunjukkan serta proses-proses yang dilalui selama perangkat lunak dieksekusi digambarkan melalui diagram alir data tingkat pertama yang ditunjukkan melalui gambar \ref{bab4:dfd-level-1}.

\begin{figure}[t!]
    \centering
    \includegraphics[width=0.9\textwidth]{Gambar/bab4:dfd-level-1.pdf}
    \caption{Diagram alir data tingkat pertama}
    \label{bab4:dfd-level-1}
\end{figure}

\section{Modul I/O}
\label{sec:des-io}

Cara kerja dari modul I/O dapat dibagi menjadi 2 fungsi utama berikut:

\begin{enumerate}
    \item \textbf{Input / Penerjemahan Masukan}
    
    Saat perangkat lunak dieksekusi melalui \textit{command line interface}, perangkat lunak akan meminta seperangkat masukan dari pengguna dalam bentuk \texttt{<nama-sumber-data> <m> <k> <r> <$\vartheta$>}. Masukan tersebut kemudian akan divalidasi agar memenuhi seluruh syarat berikut:
    
    \begin{enumerate}
        \item Berkas yang ditunjuk oleh \texttt{<nama-sumber-data>} harus merupakan berkas yang dapat ditemukan dan dapat dibaca dengan sempurna oleh perangkat lunak.
        \item Nilai dari \texttt{m} harus lebih besar sama dengan 2.
        \item Nilai dari \texttt{k} harus lebih besar sama dengan 2.
        \item Nilai dari \texttt{r} harus merupakan bilangan positif.
        \item Nilai dari $\vartheta$ harus dalam rentang [-1, 1].
    \end{enumerate}
    
    Apabila masukan yang diberikan oleh pengguna tidak memenuhi minimal salah satu dari syarat di atas, modul I/O akan menampilkan kesalahan pada pengguna dan menghentikan proses eksekusi perangkat lunak. Apabila masukan yang diberikan oleh pengguna memenuhi seluruh syarat di atas, modul I/O akan mengembalikan masukan pengguna dalam bentuk tipe data komposit. Gambar \ref{bab4:flowchart-input} menunjukkan diagram alur dari proses validasi masukan yang diberikan oleh pengguna.
    
    \iffalse
    
    Untuk mempermudah proses implementasi perangkat lunak, fungsionalitas ini akan diimplementasikan menggunakan bantuan pustaka C++ yang bernama \texttt{argparse}. Pustaka \texttt{argparse} dipilih karena memiliki kemampuan untuk mempermudah konversi tipe data menjadi tipe data yang sesuai serta menyediakan fitur untuk menampilkan bantuan penggunaan perangkat lunak dalam bentuk \textit{command line interface} pada pengguna.
    
    \fi
    
    \begin{figure}[t]
        \centering
        \includegraphics[width=\textwidth]{Gambar/bab4:flowchart-input.pdf}
        \caption{Diagram alir proses validasi masukan}
        \label{bab4:flowchart-input}
    \end{figure}
    
    \item \textbf{Output / Pembuatan Berkas Hasil}
    
    Setelah proses identifikasi rombongan selesai, hasil dari proses identifikasi tersebut akan diteruskan pada modul I/O agar hasil tersebut dapat disimpan dalam bentuk berkas teks biasa yang mudah dibaca. Berkas teks hasil akan memiliki nama yang sama dengan nama dari sumber data. 
    
    \iffalse
    
    Sebuah rombongan yang teridentifikasi akan dicatat sebagai satu baris dalam berkas teks yang dihasilkan. Rombongan tersebut akan dicatat dalam bentuk \texttt{<anggota> <frame-mulai> <frame-berakhir>}. Nilai dari \texttt{<anggota>} merupakan nomor identitas dari setiap anggota rombongan yang akan dipisahkan menggunakan koma. Fungsionalitas ini akan diimplementasikan sebagai fungsi \texttt{writeResultToFile}. Fungsionalitas ini akan diimplementasikan menggunakan pustaka standar bawaan C++17.
    
    \fi
\end{enumerate}

\section{Modul Penerjemah}
\label{sec:des-parser}

Berikut merupakan cara kerja dari modul Penerjemah:

\begin{enumerate}
    \item Menguji validitas berkas data pergerakan pejalan kaki. Apabila berkas tidak dapat dibaca oleh perangkat lunak, maka modul Penerjemah akan menampilkan pesan kesalahan dan menghentikan proses eksekusi perangkat lunak.
    \item Membaca setiap baris teks yang tercatat dalam berkas data pergerakan.
    
    \iffalse 
    
    \cristopher{Kudu jelasin gak sih ko bentuk datanya gimana?} \lionov{gak usah lah, bilang aja pokoknya ini buat nerima input, nanti di ``implementasi'' baru dijelasin setelah ngejelasin datanya kayak apa}
    
    \fi
    
    \item Untuk setiap baris data yang berhasil dibaca oleh perangkat lunak, simpan informasi posisi entitas dan nilai \textit{frame} yang menyimpan informasi posisi tersebut.
    \item Kembalikan setiap informasi entitas berupa posisi entitas pada setiap \textit{frame}.
\end{enumerate}

Gambar \ref{bab4:flowchart-penerjemah} menunjukkan diagram alir dari proses yang berlangsung dalam modul Penerjemah.

\begin{figure}[h]
    \centering
    \includegraphics[width=\textwidth]{Gambar/bab4:flowchart-penerjemah.pdf}
    \caption{Diagram alir modul penerjemah}
    \label{bab4:flowchart-penerjemah}
\end{figure}

\section{Modul Rombongan}
\label{sec:des-rombongan}

Modul Rombongan merupakan modul yang berfungsi sebagai implementasi konkrit dari algoritma identifikasi rombongan yang ditunjukkan melalui algoritma \ref{bab3:algoritma-identifikasi}. Modul rombongan juga akan mengimplementasikan algoritma \textit{dynamic time warping} yang ditunjukkan oleh algoritma \ref{bab2:dtw-pseudocode} dan perhitungan \textit{cosine similarity} yang ditunjukkan oleh rumus \ref{bab3:cosine-similarity}.

\section{Struktur Data}
\label{sec:des-struct}

Untuk mempermudah proses implementasi perangkat lunak, perlu dibuat beberapa struktur data komposit khusus. Berikut merupakan daftar struktur data akan yang dibuat:

\begin{enumerate}
    \item \textbf{Parameters}
    
    Struktur data ini akan menyimpan masukan-masukan pengguna yang diberikan melalui \textit{command line interface} yang sudah diterjemahkan, divalidasi, dan diubah ke dalam tipe data yang sesuai dengan kebutuhan perangkat lunak.
    
    \item \textbf{Entity}
    
    Struktur data ini akan menyimpan informasi-informasi penting dari entitas yang tercatat dalam data pergerakan pejalan kaki seperti nomor identitas dari entitas serta seluruh posisi dari entitas tersebut terhadap ruang $\mathbb{R}^2$ pada nilai-nilai \textit{frame} yang tercatat.
    
    \item \textbf{Rombongan}
    
    Struktur data ini akan menyimpan informasi mengenai nomor identitas dari entitas-entitas yang tergabung dalam rombongan, nilai \textit{frame} pertama di mana sekelompok entitas yang bergerak bersama memenuhi syarat pembentukan rombongan, dan nilai \textit{frame} terakhir dimana anggota-anggota rombongan masih bergerak bersama sebagai rombongan sebelum pergerakan kolektif tersebut tidak lagi memenuhi syarat-syarat pembentukan rombongan.
\end{enumerate}