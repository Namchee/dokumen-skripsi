\chapter{Perancangan}
\label{chap:perancangan}

Sebelum melalui tahap implementasi, perangkat lunak perlu melalui proses perancangan perangkat lunak. Perancangan perangkat lunak merupakan sebuah proses untuk mengidentifikasi artefak-artefak dari perangkat lunak seperti modul, fungsi, kelas, serta artefak-artefak lainnya yang bertujuan untuk memenuhi kebutuhan perangkat lunak. Manfaat utama dari perancangan perangkat lunak adalah supaya perilaku perangkat lunak yang dihasilkan dapat lebih mudah diprediksi dan dikontrol sehingga perangkat lunak dapat lebih mudah dikembangkan dan diperbaiki di masa depan \cite{budgen:04:software-design}.

\section{Fungsionalitas Perangkat Lunak}
\label{sec:functionality}

Melalui proses analisis kebutuhan perangkat lunak, maka perangkat lunak yang akan dibuat harus memiliki 2 fungsionalitas berikut:

\begin{enumerate}
    \item Membaca dan memahami masukan dari pengguna berupa data pergerakan pejalan kaki dan parameter rombongan,
    \item Melakukan identifikasi kelompok-kelompok rombongan yang terbentuk dalam data pergerakan pejalan kaki yang diberikan dalam masukan pengguna.
    \item Melakukan evaluasi terhadap hasil identifikasi rombongan.
\end{enumerate}

Berdasarkan 3 kebutuhan tersebut, diputuskan bahwa perangkat lunak akan memiliki antarmuka pengguna dalam bentuk \textit{command line interface} sederhana. Interaksi antara pengguna dan perangkat lunak berdasarkan kedua fungsionalitas tersebut digambarkan melalui diagram konteks yang ditunjukkan melalui gambar \ref{bab4:context-diagram}.

\begin{figure}[h]
    \centering
    \includegraphics[width=0.6\textwidth]{Gambar/bab4:dfd-level-0.pdf}
    \caption{Diagram konteks}
    \label{bab4:context-diagram}
\end{figure}

\noindent Kedua fungsionalitas dari perangkat lunak akan dipecah menjadi 3 modul utama yaitu:

\begin{enumerate}
    \item \textbf{Modul I/O}
    
    Modul I/O merupakan modul yang berfungsi untuk membaca masukan pengguna dan mencetak hasil identifikasi rombongan yang dihasilkan oleh modul rombongan. Terdapat dua proses yang akan dikerjakan oleh modul I/O, yaitu proses penerjemahan masukan pengguna dan proses pembuatan berkas hasil identifikasi rombongan.
    
    \item \textbf{Modul Penerjemah}
    
    Modul penerjemah merupakan modul yang berfungsi untuk menerjemahkan berkas masukan data pejalan kaki menjadi data yang dapat dipahami dan digunakan oleh perangkat lunak. Terdapat dua proses yang akan dikerjakan oleh modul penerjemah, yaitu proses penerjemahan data pergerakan dan proses penerjemahan parameter identifikasi.
    
    \item \textbf{Modul Rombongan}
    
    Modul rombongan merupakan modul yang berfungsi untuk mengidentifikasi kumpulan rombongan yang terbentuk dalam data pergerakan pejalan kaki yang sudah diterjemahkan oleh modul penerjemah. Terdapat satu proses yang akan dikerjakan oleh modul rombongan, yaitu proses identifikasi rombongan.
    
    \item \textbf{Modul Spasial}
    
    Modul spasial merupakan modul yang berfungsi untuk melakukan perhitungan kedekatan spasial antar entitas yang nantinya akan digunakan oleh modul rombongan dalam proses identifikasi rombongan.
    
    \item \textbf{Modul Evaluasi}
    
    Modul evaluasi merupakan modul yang berfungsi untuk melakukan evaluasi terhadap algoritma identifikasi rombongan yang dilakukan oleh modul rombongan. Evaluasi dilakukan dengan membandingkan hasil identifikasi rombongan dengan \textit{ground truth}.
\end{enumerate}

Interaksi antar kelima modul tersebut serta proses-proses yang dilalui selama perangkat lunak identifikasi rombongan dieksekusi digambarkan melalui diagram alir data tingkat pertama yang ditunjukkan melalui gambar \ref{bab4:dfd-level-1}.

\begin{figure}[t]
    \centering
    \includegraphics[width=\textwidth]{Gambar/bab4:dfd-level-1.pdf}
    \caption{Diagram alir data tingkat pertama}
    \label{bab4:dfd-level-1}
\end{figure}

\section{Modul I/O}
\label{sec:des-io}

Modul I/O bertanggung jawab untuk melaksanakan 2 proses berikut:

\begin{enumerate}
    \item \textbf{Input / Penerjemahan Masukan}
    
    Saat perangkat lunak dieksekusi melalui \textit{command line interface}, perangkat lunak akan meminta seperangkat masukan dari pengguna dalam bentuk \texttt{<nama-sumber-data> <m> <k> <r> <$\vartheta$> <n>}. $m$ merupakan jumlah anggota minimum dalam rombongan. $k$ merupakan rentang waktu minimum rombongan dalam satuan detik. $r$ merupakan jarak \textit{dynamic time warping} maksimum antar anggota rombongan dalam satuan meter. $\vartheta$ merupakan beda sudut maksimum antar anggota rombongan dalam satuan derajat. $n$ merupakan jumlah kedekatan minimum agar sebuah entitas dapat tergabung dalam sebuah rombongan.
    
    Sebelum perangkat lunak menjalankan proses selanjutnya, masukan tersebut akan divalidasi supaya memenuhi seluruh syarat berikut:
    
    \begin{enumerate}
        \item Nilai dari \texttt{m} harus merupakan bilangan bulat yang lebih besar dari 2.
        \item Nilai dari \texttt{k} harus merupakan bilangan positif.
        \item Nilai dari \texttt{r} harus merupakan bilangan positif.
        \item Nilai dari \texttt{n} harus merupakan bilangan non-negatif.
    \end{enumerate}
    
    Apabila masukan yang diberikan oleh pengguna tidak memenuhi seluruh syarat di atas, proses penerjemahan masukan akan menampilkan pesan kesalahan pada pengguna dan menghentikan proses eksekusi perangkat lunak.
    
    Setelah proses validasi masukan selesai, modul I/O akan mengembalikan masukan pengguna dalam bentuk tipe data komposit tanpa melakukan proses tambahan lainnya. Gambar \ref{bab4:flowchart-input} menunjukkan diagram alur dari proses validasi masukan yang diberikan oleh pengguna.
    
    \begin{figure}[h]
        \centering
        \includegraphics[width=\textwidth]{Gambar/bab4:flowchart-input.pdf}
        \caption{Diagram alir proses validasi masukan}
        \label{bab4:flowchart-input}
    \end{figure}
    
    \item \textbf{Output / Pembuatan Berkas Hasil}
    
    Setelah proses identifikasi rombongan selesai, hasil dari proses identifikasi tersebut akan diteruskan pada modul I/O agar hasil tersebut dapat disimpan dalam bentuk berkas teks biasa yang mudah dibaca dan dievaluasi.
    
    Berkas teks hasil akan mengandung informasi mengenai parameter identifikasi rombongan yang digunakan, evaluasi hasil identifikasi rombongan yang dihasilkan oleh modul evaluasi, serta daftar rombongan yang berhasil teridentifikasi.
\end{enumerate}

\section{Modul Penerjemah}
\label{sec:des-parser}

Modul penerjemah bertanggung jawab untuk melaksanakan 2 proses berikut:

\begin{enumerate}
    \item \textbf{Penerjemahan Data Pergerakan}
    
    Setelah nama berkas  modul I/O, modul penerjemah akan mengubah data pergerakan yang terdapat pada berkas data menjadi bentuk yang dapat dipahami oleh perangkat lunak. Berikut merupakan langkah-langkah yang dikerjakan dalam proses penerjemahan data pergerakan:
    
    \begin{enumerate}
        \item Menguji validitas berkas data pergerakan pejalan kaki. Apabila berkas tidak dapat dibaca oleh perangkat lunak, maka modul penerjemah akan menampilkan pesan kesalahan dan menghentikan proses eksekusi perangkat lunak.
        
        \item Membaca setiap baris teks yang tercatat dalam berkas data pergerakan.
    
        \iffalse 
    
        \cristopher{Kudu jelasin gak sih ko bentuk datanya gimana?} \lionov{gak usah lah, bilang aja pokoknya ini buat nerima input, nanti di ``implementasi'' baru dijelasin setelah ngejelasin datanya kayak apa}
    
        \fi
    
        \item Untuk setiap baris data yang berhasil dibaca oleh perangkat lunak, simpan informasi posisi entitas dan nilai \textit{frame} yang menyimpan informasi posisi tersebut.
        
        \item Untuk setiap entitas yang berhasil dibaca, periksa keberadaan entitas tersebut untuk setiap \textit{frame} yang tercatat. Apabila entitas tidak terdapat pada sebuah \textit{frame}, tandai posisi entitas tersebut pada \textit{frame} yang dimaksud menggunakan sebuah \textit{anchor value}. \textit{Anchor value} akan digunakan untuk memeriksa keberadaan entitas pada sebuah \textit{frame}.
        
        \item Kembalikan setiap informasi entitas berupa posisi setiap entitas bergerak yang tercatat dalam data pergerakan pada setiap \textit{frame} yang terdapat dalam data pergerakan.
    \end{enumerate}
    
    Gambar \ref{bab4:flowchart-penerjemah} menunjukkan diagram alir dari proses penerjemahan data pergerakan yang berlangsung dalam modul Penerjemah.

    \item \textbf{Penerjemahan Parameter Identifikasi}
    
    Sebelum proses identifikasi rombongan dilakukan, perangkat lunak perlu mengetahui parameter-parameter yang akan digunakan dalam proses identifikasi rombongan. Parameter identifikasi diperoleh dengan mengolah masukan pengguna yang diperoleh dari modul I/O.
    
    Terdapat 2 nilai yang akan diproses oleh fungsi ini, yaitu $k$ dan $\vartheta$. Nilai $k$ akan diterjemahkan menjadi satuan \textit{frame}. Nilai dari $\vartheta$ akan diterjemahkan menjadi nilai \textit{cosinus} dari sudut tersebut. Parameter-parameter lainnya tidak akan melalui proses lanjutan apapun dan akan langsung diteruskan pada modul rombongan.
\end{enumerate}

\begin{figure}[t]
    \centering
    \includegraphics[width=\textwidth]{Gambar/bab4:flowchart-penerjemah.pdf}
    \caption{Diagram alir modul penerjemah}
    \label{bab4:flowchart-penerjemah}
\end{figure}

\section{Modul Rombongan}
\label{sec:des-rombongan}

Modul rombongan merupakan modul yang berfungsi sebagai implementasi konkrit dari algoritma identifikasi rombongan yang ditunjukkan melalui Algoritma \ref{bab3:algoritma-identifikasi}. Modul rombongan akan menghasilkan rombongan-rombongan yang teridentifikasi pada data pergerakan yang sesuai dengan parameter identifikasi yang diterjemahkan dari masukan pengguna oleh modul penerjemah. Pada proses identifikasi rombongan, modul rombongan akan menggunakan algoritma \textit{dynamic time warping} dan perhitungan \textit{cosine similarity} yang diimplementasikan dalam modul spasial.

\section{Modul Spasial}
\label{sec:des-spatial}

Modul spasial merupakan modul yang berisi implementasi dari algoritma-algoritma yang akan digunakan untuk menentukan kedekatan spasial antara dua buah entitas yang digunakan selama proses identifikasi rombongan. Implementasi tersebut dipisahkan dari modul rombongan untuk mempermudah pengujian perangkat lunak. Modul spasial akan mengimplementasikan algoritma \textit{dynamic time warping} yang ditunjukkan oleh Algoritma \ref{bab2:dtw-pseudocode} dan perhitungan \textit{cosine similarity} yang ditunjukkan oleh Rumus \ref{bab3:cosine-similarity}.

\section{Modul Evaluasi}
\label{sec:des-evaluation}

Modul evaluasi merupakan modul yang berfungsi untuk melakukan evaluasi hasil identifikasi rombongan yang dihasilkan oleh modul rombongan dengan membandingkan hasil identifikasi rombongan dengan data \textit{ground truth} yang sesuai dengan masukan data pergerakan. Evaluasi hasil identifikasi dilakukan secara kuantitatif dengan menghitung nilai \textit{precision}, \textit{recall}, dan \textit{F1 score} dari hasil identifikasi rombongan.

\section{Struktur Data}
\label{sec:des-struct}

Untuk mempermudah proses implementasi perangkat lunak, diperlukan beberapa struktur data komposit yang terdiri dari berbagai nilai primitif. Berikut merupakan daftar struktur data komposit yang akan dibuat:

\begin{enumerate}
    \item \textbf{Arguments}
    
    Struktur data ini akan menyimpan masukan-masukan mentah dari pengguna yang diberikan melalui \textit{command line interface}. Masukan-masukan tersebut akan melalui proses validasi dasar dan diubah menjadi tipe data yang dapat dipahami oleh perangkat lunak.
    
    \item \textbf{Parameters}
    
    Struktur data ini akan menyimpan masukan-masukan pengguna yang telah diproses menjadi parameter-parameter yang akan digunakan oleh algoritma identifikasi rombongan.  
    
    \item \textbf{Entity}
    
    Struktur data ini akan menyimpan informasi-informasi penting dari entitas yang tercatat dalam data pergerakan pejalan kaki seperti nomor identitas dari entitas serta seluruh posisi dari entitas tersebut pada ruang gerak $\mathbb{R}^2$.
    
    \item \textbf{Rombongan}
    
    Struktur data ini akan menyimpan informasi mengenai nomor identitas dari entitas-entitas yang tergabung dalam rombongan serta daftar durasi terbentuknya rombongan. Durasi rombongan akan menyimpan nilai \textit{frame} pertama di mana sekelompok entitas yang bergerak bersama memenuhi syarat pembentukan rombongan, dan nilai \textit{frame} terakhir dimana anggota-anggota rombongan masih bergerak bersama sebagai rombongan sebelum pergerakan kolektif tersebut tidak lagi memenuhi syarat-syarat pembentukan rombongan.
\end{enumerate}